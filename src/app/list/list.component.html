<div class="bg-gray-100 min-h-screen">
  <!-- Header -->
  <app-header [title]="title" subtitulo="Lista de alumnos"></app-header>

  <div class="max-w-9/10 mx-auto p-4 sm:p-8 mt-4">
    <!-- Buscador -->
    <div class="flex flex-col sm:flex-row gap-2 sm:gap-4 mb-6">
      <div class="relative flex-1">
        <input
          type="text"
          placeholder="Buscar por nombre, matrícula, CURP, correo..."
          [(ngModel)]="terminoBusqueda"
          (input)="buscarAlumnos()"
          class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-md hover:ring focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white placeholder:text-gray-400 disabled:opacity-50 transition"
        />
        <button
          *ngIf="terminoBusqueda"
          (click)="limpiarBusqueda()"
          class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition"
          title="Limpiar búsqueda"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>
      </div>
      <div class="text-sm text-gray-600 flex items-center">
        Mostrando {{ alumnosFiltrados.length }} de {{ alumnos.length }} alumnos
      </div>
    </div>

    @if (cargando) {
    <div class="flex justify-center items-center py-8">
      <div
        class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
      ></div>
    </div>
    }

    <!-- Error -->
    @if (error && !cargando) {
    <div
      class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"
    >
      {{ error }}
    </div>
    } @if (!cargando && !error) {
    <!-- Mensaje cuando no hay resultados -->
    @if (alumnosFiltrados.length === 0 && terminoBusqueda) {
    <div class="text-center py-8">
      <div class="text-gray-500 text-lg mb-2">No se encontraron resultados</div>
      <div class="text-gray-400 text-sm">
        Intenta con otros términos de búsqueda
      </div>
    </div>
    } @if (alumnosFiltrados.length > 0) {
    <!-- Vista de tabla para escritorio -->
    <div class="hidden md:block relative overflow-x-auto overflow-y-hidden">
      <table class="table-auto w-full text-left">
        <thead class="uppercase">
          <tr class="text-sky-500">
            <th scope="col" class="p-2">#</th>
            <th scope="col" class="px-6 py-2">CURP</th>
            <th scope="col" class="px-6 py-2">Matrícula</th>
            <th scope="col" class="px-6 py-2">Nombre</th>
            <th scope="col" class="px-6 py-2">Correo</th>
            <th scope="colgroup" class="px-6">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let alumno of alumnosFiltrados; let i = index"
            class="text-indigo-600 hover:text-indigo-800 hover:bg-white transition border-b border-t border-indigo-300"
            [ngClass]="i % 2 === 0 ? 'bg-indigo-100' : 'bg-indigo-200'"
          >
            <td class="p-2">{{ i + 1 }}</td>
            <td class="px-6 py-2">{{ alumno.CURP }}</td>
            <td class="px-6 py-2">{{ alumno.Matricula }}</td>

            <td class="px-6 py-2">
              {{ alumno.Nombre }} {{ alumno.ApellidoPaterno }}
              {{ alumno.ApellidoMaterno }}
            </td>
            <td class="px-6 py-2">{{ alumno.Correo }}</td>
            <td class="px-6 py-2 flex gap-3">
              <button
                (click)="eliminarAlumno(alumno)"
                class="transition duration-180 hover:filter hover:brightness-500 hover:cursor-pointer hover:scale-105"
                title="Eliminar alumno"
              >
                <img src="assets/DETALLE.png" alt="Eliminar" class="w-7 h-7" />
              </button>
              <button
                (click)="editarAlumno(alumno)"
                class="transition duration-180 hover:filter hover:brightness-180 hover:cursor-pointer hover:scale-105"
                title="Editar alumno"
              >
                <img src="assets/DETALLE2.png" alt="Editar" class="w-7 h-7" />
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Vista de tarjetas para móvil -->
    <div class="md:hidden space-y-4">
      <div
        *ngFor="let alumno of alumnosFiltrados; let i = index"
        class="bg-white rounded-lg shadow-md border border-gray-200 p-4 hover:shadow-lg transition-shadow"
      >
        <!-- Header de la tarjeta con número y acciones -->
        <div class="flex justify-between items-start mb-3">
          <span
            class="bg-indigo-100 text-indigo-800 text-sm font-medium px-2 py-1 rounded"
          >
            #{{ i + 1 }}
          </span>
          <div class="flex gap-2">
            <button
              (click)="editarAlumno(alumno)"
              class="p-2 rounded-full hover:bg-gray-200 transition"
              title="Editar alumno"
            >
              <img
                src="assets/DETALLE2.png"
                alt="Editar"
                class="w-[2rem] h-[2rem]"
              />
            </button>
            <button
              (click)="eliminarAlumno(alumno)"
              class="p-2 rounded-full hover:bg-red-200 transition"
              title="Eliminar alumno"
            >
              <img
                src="assets/DETALLE.png"
                alt="Eliminar"
                class="w-[2rem] h-[2rem]"
              />
            </button>
          </div>
        </div>

        <!-- Información del alumno -->
        <div class="space-y-2">
          <div>
            <span class="text-sm font-semibold text-gray-600">Nombre:</span>
            <p class="text-gray-900 font-medium">
              {{ alumno.Nombre }} {{ alumno.ApellidoPaterno }}
              {{ alumno.ApellidoMaterno }}
            </p>
          </div>

          <div>
            <span class="text-sm font-semibold text-gray-600">Matrícula:</span>
            <p class="text-gray-900">{{ alumno.Matricula }}</p>
          </div>

          <div>
            <span class="text-sm font-semibold text-gray-600">CURP:</span>
            <p class="text-gray-900 text-sm break-all">{{ alumno.CURP }}</p>
          </div>

          <div>
            <span class="text-sm font-semibold text-gray-600">Correo:</span>
            <p class="text-gray-900 text-sm break-all">{{ alumno.Correo }}</p>
          </div>
        </div>
      </div>
    </div>
    } }
  </div>
</div>
